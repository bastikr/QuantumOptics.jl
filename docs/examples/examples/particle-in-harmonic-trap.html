

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Particle in harmonic trap potential &mdash; Julia Quantum Optics</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Julia Quantum Optics" href="../index.html"/>
        <link rel="up" title="Examples" href="../examples.html"/>
        <link rel="next" title="API" href="../api.html"/>
        <link rel="prev" title="Jaynes-Cummings model" href="jaynes-cummings-model.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> QuantumOptics.jl
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bases.html">Bases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../states.html">States</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../superoperators.html">Super-operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantumsystems.html">Quantum systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timeevolution.html">Time-evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steadystate.html">Steady state</a></li>
<li class="toctree-l1"><a class="reference internal" href="../correlations.html">Two-time correlation functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectralanalysis.html">Spectral Analysis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="jaynes-cummings-model.html">Jaynes-Cummings model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Particle in harmonic trap potential</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">QuantumOptics.jl</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../examples.html">Examples</a> &raquo;</li>
      
    <li>Particle in harmonic trap potential</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/particle-in-harmonic-trap.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><em>This notebook can be found on</em>
<a class="reference external" href="https://github.com/bastikr/QuantumOptics.jl/blob/master/examples/particle-in-harmonic-trap.ipynb">github</a></p>
<div class="section" id="particle-in-harmonic-trap-potential">
<h1>Particle in harmonic trap potential<a class="headerlink" href="#particle-in-harmonic-trap-potential" title="Permalink to this headline">¶</a></h1>
<p>A particle in a harmonic trap is described by a Hamiltonian of the form</p>
<div class="math">
\[H = \frac{\hat{p}^2}{2m} + \frac{1}{2}m \omega^2 \hat{x}^2\]</div>
<p>For numerical simulations we are forced to work in a basis. For
particles there are two common choices. We can either work in real space
or alternatively in momentum space.</p>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">QuantumOptics</span>
<span class="k">using</span> <span class="n">PyPlot</span>
</pre></div>
</div>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="c"># System Parameters</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">ω</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c"># Strength of trapping potential;</span>
</pre></div>
</div>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="c"># Position Basis</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">Npoints</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">b_position</span> <span class="o">=</span> <span class="n">PositionBasis</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">Npoints</span><span class="p">)</span>

<span class="c"># Hamiltonian in real space basis</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">momentumoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">positionoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">ω</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<p>Of course we could also choose to work in momentum space:</p>
<p>From a PositionBasis <strong>QuantumOptics.jl</strong> can automatically infere the
corresponding MomentumBasis by calculating
<span class="math">\(p_\mathrm{min} = -\pi/dx\)</span> and <span class="math">\(p_\mathrm{max} = \pi/dx\)</span>
where <span class="math">\(dx = (x_\mathrm{max} - x_\mathrm{min})/N\)</span></p>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="n">b_momentum</span> <span class="o">=</span> <span class="n">MomentumBasis</span><span class="p">(</span><span class="n">b_position</span><span class="p">);</span>

<span class="c"># Hamiltonian</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">momentumoperator</span><span class="p">(</span><span class="n">b_momentum</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">positionoperator</span><span class="p">(</span><span class="n">b_momentum</span><span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">ω</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<p>However, both choices are not optimal since in real space the position
operator is diagonal while the momentum operator is a completely dense
matrix and vice versa for the momentum space. Therefore, the calculation
will scale with <span class="math">\(N^2\)</span> where <span class="math">\(N\)</span> is the dimension of the
Hilbert space. A commonly used trick is to utilize fast Fourier
transformation to convert the state of the system between real and
momentum space. This allows us to always use the diagonal form of the
operators which all in all speeds up the calculations to
<span class="math">\(N \log N\)</span>.</p>
<p>This idea is implemented by the FFTOperator which performs a fast
Fourier transformation on the multiplied state.</p>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="c"># Transforms a state multiplied from the right side from real space</span>
<span class="c"># to momentum space.</span>
<span class="n">op_fft</span> <span class="o">=</span> <span class="n">particle</span><span class="o">.</span><span class="n">FFTOperator</span><span class="p">(</span><span class="n">b_momentum</span><span class="p">,</span> <span class="n">b_position</span><span class="p">);</span>
</pre></div>
</div>
<p>To use this operator in a Hamiltonian we additionally need the concept
of lazy operators which allow us to delay certain operations to a later
point in the simulation. E.g. the LazyProduct allows us to do
<span class="math">\(A*(B*x)\)</span> instead of <span class="math">\((A*B)*x\)</span> which means for our case that
the matrix-matrix product never has to be calculated directly but only
two matrix-vector multiplications instead.</p>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="n">op_inversefft</span> <span class="o">=</span> <span class="n">dagger</span><span class="p">(</span><span class="n">op_fft</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">positionoperator</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">momentumoperator</span><span class="p">(</span><span class="n">b_momentum</span><span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">LazyProduct</span><span class="p">(</span><span class="n">op_inversefft</span><span class="p">,</span> <span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="n">m</span><span class="p">,</span> <span class="n">op_fft</span><span class="p">)</span> <span class="o">+</span> <span class="n">ω</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<p>Finally we can simulate the time evolution according to a Schroedinger
equation.</p>
<div class="code python highlight-julia"><div class="highlight"><pre><span></span><span class="c"># Initial state</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma0</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">Ψ0</span> <span class="o">=</span> <span class="n">gaussianstate</span><span class="p">(</span><span class="n">b_position</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">sigma0</span><span class="p">);</span>

<span class="c"># Time evolution</span>
<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">20</span><span class="p">;]</span>
<span class="n">tout</span><span class="p">,</span> <span class="n">Ψt</span> <span class="o">=</span> <span class="n">timeevolution</span><span class="o">.</span><span class="n">schroedinger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Ψ0</span><span class="p">,</span> <span class="n">H</span><span class="p">);</span>

<span class="c"># Plot dynamics of particle density</span>
<span class="n">x_points</span> <span class="o">=</span> <span class="n">particle</span><span class="o">.</span><span class="n">samplepoints</span><span class="p">(</span><span class="n">b_position</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">Ψ0</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">ω</span><span class="o">*</span><span class="n">x_points</span><span class="o">.^</span><span class="mi">2</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">maximum</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">/</span><span class="n">maximum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">L&quot;x&quot;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">L&quot;| \Psi(t) |^2&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">V</span><span class="o">/</span><span class="n">C</span><span class="p">,</span> <span class="s">&quot;k&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">Ψ</span><span class="o">=</span><span class="n">Ψt</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">abs</span><span class="p">(</span><span class="n">Ψ</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
<img alt="../_images/particle-in-harmonic-trap_12_0.png" src="../_images/particle-in-harmonic-trap_12_0.png" />
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api.html" class="btn btn-neutral float-right" title="API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="jaynes-cummings-model.html" class="btn btn-neutral" title="Jaynes-Cummings model" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Sebastian Krämer.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>